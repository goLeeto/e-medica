<!DOCTYPE html>
<html>
<head>
	<title> Google Maps</title>
</head>
<script type="text/javascript" src="includes/jquery-1.7.1.min.js"></script>
<script src="http://maps.google.com/maps/api/js?key=AIzaSyAZGrqpxtNLhMqcP8e0FmbHaWDJAUfsQvo&callback=initialize"></script>
<script type="text/javascript">
$(document).ready(function(){
	init();
	
});
	var citymap=[];

function fshi(name){
	
}
function init() {
	$.post("map.php",function(datas){
	var datas = JSON.parse(datas);
	console.log(datas);
	var latt;
	var lngg;
	var val;
	var name;
	for (var i = 0; i < datas.length; i++) {
		latt = parseFloat(datas[i][1]);
		lngg = parseFloat(datas[i][2]);
		name = datas[i][3];
		val = datas[i][4];
		citymap [i] = {
			center : {lat:latt,lng:lngg},
			val : val,
			name:name,
		}
	}
	
  // Create the map.
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 7,
    center: {lat: 41.1533, lng: 20.1683},
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });

  // Construct the circle for each value in citymap.
  // Note: We scale the area of the circle based on the population.
  for (var i =0;i<citymap.length; i++) {
    // Add the circle for this city to the map.
    var cityCircle = new google.maps.Circle({
      strokeColor: '#FF0000',
      strokeOpacity: 0.8,
      strokeWeight: 2,
      fillColor: '#FF0000',
      fillOpacity: 0.35,
      map: map,
      center: citymap[i].center,
      radius: citymap[i].val*800,
      name:citymap[i].name
    });
    cityCircle.addListener("click",function(){
    	var infowindow = new google.maps.InfoWindow({
    		content:"Qyteti: " +this.name + " Numri i QSH: " + this.radius/800 + "<br/><br/> <input type='button' id='fshi' data-name='"+this.name+"' value='Delete'>",
    		position:this.center
    	});
    	infowindow.open(map);
    	var emri = this.name;
    	setTimeout(function(){
    		var butoni = document.getElementById("fshi");
		butoni.addEventListener("click",function(name){
			
	$.post("delete.php", {name:emri}, function(e){
		init();

	});
		});
	},1000);
    	



    });
  }
  });
}
</script>
<body>
<div id="map" style="position:relative;min-width: 500px; max-width :500px; min-height: 500px; max-height: 500px;display: inline-block;"></div>
</body>
</html>










